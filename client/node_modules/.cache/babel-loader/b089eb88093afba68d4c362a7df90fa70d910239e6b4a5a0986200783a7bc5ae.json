{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\kevin\\\\Downloads\\\\Bus4-main\\\\Bus4-main\\\\Bus4\\\\client\\\\src\\\\components\\\\ReservationCreate.jsx\",\n  _s = $RefreshSig$();\nimport axios from \"axios\";\nimport { useNavigate, useParams } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst {\n  useState,\n  useContext,\n  useEffect,\n  useCallback\n} = require(\"react\");\nconst {\n  UserContext\n} = require(\"../context/UserContext\");\nconst ReservationCreate = () => {\n  _s();\n  const navigate = useNavigate();\n  const {\n    user\n  } = useContext(UserContext); // Agregado para obtener el usuario del contexto\n  const busId = useParams().busId;\n  const [bus, setBus] = useState(null);\n  const [reservas, setReservas] = useState([]); // Agregado para guardar las reservas del bus\n  const [numAsiento, setNumAsiento] = useState(0);\n  const fetchBus = useCallback(async () => {\n    try {\n      const response = await axios.get(`http://localhost:8000/api/bus/${busId}`);\n      setBus(response.data.bus);\n      setReservas(response.data.reservas);\n    } catch (error) {\n      console.error(\"Error al obtener bus:\", error);\n    }\n  }, [busId]);\n  const handleSubmit = async event => {\n    event.preventDefault();\n    if (!numAsiento) {\n      alert(\"Debes seleccionar un asiento.\");\n      return;\n    }\n    try {\n      const response = await axios.post(\"http://localhost:8000/api/reservas/\", {\n        bus: bus._id,\n        user: user.email,\n        numAsiento\n      });\n      if (response.data.saved) {\n        fetchBus();\n        setNumAsiento(0);\n        alert(\"Reserva realizada con éxito.\");\n        navigate(\"/BusSearch\");\n      }\n    } catch (error) {\n      console.error(\"Error al realizar la reserva:\", error);\n      alert(\"Error al realizar la reserva.\");\n    }\n  };\n  const isReserved = numAsiento => {\n    return reservas.some(reserva => reserva.numAsiento === numAsiento);\n  };\n  useEffect(() => {\n    fetchBus();\n  }, [fetchBus]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"container mt-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: /*#__PURE__*/_jsxDEV(\"b\", {\n          children: [user === null || user === void 0 ? void 0 : user.firstName, \" \", user === null || user === void 0 ? void 0 : user.lastName]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 17\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 13\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: bus === null || bus === void 0 ? void 0 : bus.empresa\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        id: \"itinerario\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Salida:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 69,\n            columnNumber: 24\n          }, this), \" \", bus === null || bus === void 0 ? void 0 : bus.salida]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 69,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Destino:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 70,\n            columnNumber: 24\n          }, this), \" \", bus === null || bus === void 0 ? void 0 : bus.destino]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Hora de salida:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 24\n          }, this), \" \", bus === null || bus === void 0 ? void 0 : bus.horaSalida]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"b\", {\n            children: \"Precio:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 72,\n            columnNumber: 24\n          }, this), \" \", bus === null || bus === void 0 ? void 0 : bus.precioBoleto, \" Gs.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row\",\n        children: [...Array(bus === null || bus === void 0 ? void 0 : bus.capacidadBus)].map((_, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col\",\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            disabled: isReserved(index + 1),\n            type: \"button\",\n            className: `btn btn-${numAsiento === index + 1 ? \"primary\" : \"secondary\"}`,\n            onClick: () => setNumAsiento(index + 1),\n            children: index + 1\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 29\n          }, this)\n        }, index, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary mt-4\",\n        children: \"Reservar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 9\n  }, this);\n};\n_s(ReservationCreate, \"56+4gs5fCkPttngdMpucPdX6ww8=\", false, function () {\n  return [useNavigate, useParams];\n});\n_c = ReservationCreate;\nexport default ReservationCreate;\nvar _c;\n$RefreshReg$(_c, \"ReservationCreate\");","map":{"version":3,"names":["axios","useNavigate","useParams","jsxDEV","_jsxDEV","useState","useContext","useEffect","useCallback","require","UserContext","ReservationCreate","_s","navigate","user","busId","bus","setBus","reservas","setReservas","numAsiento","setNumAsiento","fetchBus","response","get","data","error","console","handleSubmit","event","preventDefault","alert","post","_id","email","saved","isReserved","some","reserva","className","children","firstName","lastName","fileName","_jsxFileName","lineNumber","columnNumber","empresa","id","salida","destino","horaSalida","precioBoleto","onSubmit","Array","capacidadBus","map","_","index","disabled","type","onClick","_c","$RefreshReg$"],"sources":["C:/Users/kevin/Downloads/Bus4-main/Bus4-main/Bus4/client/src/components/ReservationCreate.jsx"],"sourcesContent":["import axios from \"axios\";\nimport { useNavigate, useParams } from \"react-router-dom\";\n\nconst { useState, useContext, useEffect, useCallback } = require(\"react\");\nconst { UserContext } = require(\"../context/UserContext\");\n\n\nconst ReservationCreate = () => {\n    const navigate = useNavigate();\n\n    const { user } = useContext(UserContext); // Agregado para obtener el usuario del contexto\n    const busId = useParams().busId;\n\n    const [bus, setBus] = useState(null);\n    const [reservas , setReservas] = useState([]); // Agregado para guardar las reservas del bus\n    const [numAsiento, setNumAsiento] = useState(0);\n\n    const fetchBus = useCallback(async () => {\n        try {\n            const response = await axios.get(`http://localhost:8000/api/bus/${busId}`);\n            setBus(response.data.bus);\n            setReservas(response.data.reservas);\n        } catch (error) {\n            console.error(\"Error al obtener bus:\", error);\n        }\n    }, [busId]);\n\n    const handleSubmit = async (event) => {\n        event.preventDefault();\n\n        if (!numAsiento) {\n            alert(\"Debes seleccionar un asiento.\");\n            return;\n        }\n\n        try {\n            const response = await axios.post(\"http://localhost:8000/api/reservas/\",{\n                    bus: bus._id,\n                    user: user.email,\n                    numAsiento,\n                }\n            );\n            if (response.data.saved) {\n                fetchBus();\n                setNumAsiento(0);\n                alert(\"Reserva realizada con éxito.\");\n                navigate(\"/BusSearch\")\n            }\n        } catch (error) {\n            console.error(\"Error al realizar la reserva:\", error);\n            alert(\"Error al realizar la reserva.\");\n        }\n    };\n\n    const isReserved = (numAsiento) => {\n        return reservas.some((reserva) => reserva.numAsiento === numAsiento);\n    }\n\n    useEffect(() => {\n        fetchBus();\n    }, [fetchBus])\n\n    return (\n        <div className=\"container mt-4\">\n            <div>\n            <h2><b>{user?.firstName} {user?.lastName}</b></h2>\n                <h4>{bus?.empresa}</h4>\n                <div id=\"itinerario\">\n                    <p><b>Salida:</b> {bus?.salida}</p>\n                    <p><b>Destino:</b> {bus?.destino}</p>\n                    <p><b>Hora de salida:</b> {bus?.horaSalida}</p>\n                    <p><b>Precio:</b> {bus?.precioBoleto} Gs.</p>\n                </div>\n            </div>\n            <form onSubmit={handleSubmit}>\n                {/* bus.capacidadBus tiene el numero de hacientos, generar 1 boton para cada haciento */}\n\n                <div className=\"row\">\n                    {[...Array(bus?.capacidadBus)].map((_, index) => (\n                        <div key={index} className=\"col\">\n                            <button\n                            disabled={isReserved(index + 1)}\n                                type=\"button\"\n                                className={`btn btn-${numAsiento === index + 1 ? \"primary\" : \"secondary\"}`}\n                                onClick={() => setNumAsiento(index + 1)}\n                            >\n                                {index + 1}\n                            </button>\n                        </div>\n                    ))}\n                </div>\n                \n                <button type=\"submit\" className=\"btn btn-primary mt-4\">Reservar</button>\n            </form>\n        </div>\n    );\n}\n\nexport default ReservationCreate;"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,WAAW,EAAEC,SAAS,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE1D,MAAM;EAAEC,QAAQ;EAAEC,UAAU;EAAEC,SAAS;EAAEC;AAAY,CAAC,GAAGC,OAAO,CAAC,OAAO,CAAC;AACzE,MAAM;EAAEC;AAAY,CAAC,GAAGD,OAAO,CAAC,wBAAwB,CAAC;AAGzD,MAAME,iBAAiB,GAAGA,CAAA,KAAM;EAAAC,EAAA;EAC5B,MAAMC,QAAQ,GAAGZ,WAAW,CAAC,CAAC;EAE9B,MAAM;IAAEa;EAAK,CAAC,GAAGR,UAAU,CAACI,WAAW,CAAC,CAAC,CAAC;EAC1C,MAAMK,KAAK,GAAGb,SAAS,CAAC,CAAC,CAACa,KAAK;EAE/B,MAAM,CAACC,GAAG,EAAEC,MAAM,CAAC,GAAGZ,QAAQ,CAAC,IAAI,CAAC;EACpC,MAAM,CAACa,QAAQ,EAAGC,WAAW,CAAC,GAAGd,QAAQ,CAAC,EAAE,CAAC,CAAC,CAAC;EAC/C,MAAM,CAACe,UAAU,EAAEC,aAAa,CAAC,GAAGhB,QAAQ,CAAC,CAAC,CAAC;EAE/C,MAAMiB,QAAQ,GAAGd,WAAW,CAAC,YAAY;IACrC,IAAI;MACA,MAAMe,QAAQ,GAAG,MAAMvB,KAAK,CAACwB,GAAG,CAAE,iCAAgCT,KAAM,EAAC,CAAC;MAC1EE,MAAM,CAACM,QAAQ,CAACE,IAAI,CAACT,GAAG,CAAC;MACzBG,WAAW,CAACI,QAAQ,CAACE,IAAI,CAACP,QAAQ,CAAC;IACvC,CAAC,CAAC,OAAOQ,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,uBAAuB,EAAEA,KAAK,CAAC;IACjD;EACJ,CAAC,EAAE,CAACX,KAAK,CAAC,CAAC;EAEX,MAAMa,YAAY,GAAG,MAAOC,KAAK,IAAK;IAClCA,KAAK,CAACC,cAAc,CAAC,CAAC;IAEtB,IAAI,CAACV,UAAU,EAAE;MACbW,KAAK,CAAC,+BAA+B,CAAC;MACtC;IACJ;IAEA,IAAI;MACA,MAAMR,QAAQ,GAAG,MAAMvB,KAAK,CAACgC,IAAI,CAAC,qCAAqC,EAAC;QAChEhB,GAAG,EAAEA,GAAG,CAACiB,GAAG;QACZnB,IAAI,EAAEA,IAAI,CAACoB,KAAK;QAChBd;MACJ,CACJ,CAAC;MACD,IAAIG,QAAQ,CAACE,IAAI,CAACU,KAAK,EAAE;QACrBb,QAAQ,CAAC,CAAC;QACVD,aAAa,CAAC,CAAC,CAAC;QAChBU,KAAK,CAAC,8BAA8B,CAAC;QACrClB,QAAQ,CAAC,YAAY,CAAC;MAC1B;IACJ,CAAC,CAAC,OAAOa,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,+BAA+B,EAAEA,KAAK,CAAC;MACrDK,KAAK,CAAC,+BAA+B,CAAC;IAC1C;EACJ,CAAC;EAED,MAAMK,UAAU,GAAIhB,UAAU,IAAK;IAC/B,OAAOF,QAAQ,CAACmB,IAAI,CAAEC,OAAO,IAAKA,OAAO,CAAClB,UAAU,KAAKA,UAAU,CAAC;EACxE,CAAC;EAEDb,SAAS,CAAC,MAAM;IACZe,QAAQ,CAAC,CAAC;EACd,CAAC,EAAE,CAACA,QAAQ,CAAC,CAAC;EAEd,oBACIlB,OAAA;IAAKmC,SAAS,EAAC,gBAAgB;IAAAC,QAAA,gBAC3BpC,OAAA;MAAAoC,QAAA,gBACApC,OAAA;QAAAoC,QAAA,eAAIpC,OAAA;UAAAoC,QAAA,GAAI1B,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE2B,SAAS,EAAC,GAAC,EAAC3B,IAAI,aAAJA,IAAI,uBAAJA,IAAI,CAAE4B,QAAQ;QAAA;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAI,CAAC,eAC9C1C,OAAA;QAAAoC,QAAA,EAAKxB,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAE+B;MAAO;QAAAJ,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAK,CAAC,eACvB1C,OAAA;QAAK4C,EAAE,EAAC,YAAY;QAAAR,QAAA,gBAChBpC,OAAA;UAAAoC,QAAA,gBAAGpC,OAAA;YAAAoC,QAAA,EAAG;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,KAAC,EAAC9B,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEiC,MAAM;QAAA;UAAAN,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACnC1C,OAAA;UAAAoC,QAAA,gBAAGpC,OAAA;YAAAoC,QAAA,EAAG;UAAQ;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,KAAC,EAAC9B,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEkC,OAAO;QAAA;UAAAP,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eACrC1C,OAAA;UAAAoC,QAAA,gBAAGpC,OAAA;YAAAoC,QAAA,EAAG;UAAe;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,KAAC,EAAC9B,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEmC,UAAU;QAAA;UAAAR,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAI,CAAC,eAC/C1C,OAAA;UAAAoC,QAAA,gBAAGpC,OAAA;YAAAoC,QAAA,EAAG;UAAO;YAAAG,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OAAG,CAAC,KAAC,EAAC9B,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEoC,YAAY,EAAC,MAAI;QAAA;UAAAT,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OAAG,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAC5C,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACL,CAAC,eACN1C,OAAA;MAAMiD,QAAQ,EAAEzB,YAAa;MAAAY,QAAA,gBAGzBpC,OAAA;QAAKmC,SAAS,EAAC,KAAK;QAAAC,QAAA,EACf,CAAC,GAAGc,KAAK,CAACtC,GAAG,aAAHA,GAAG,uBAAHA,GAAG,CAAEuC,YAAY,CAAC,CAAC,CAACC,GAAG,CAAC,CAACC,CAAC,EAAEC,KAAK,kBACxCtD,OAAA;UAAiBmC,SAAS,EAAC,KAAK;UAAAC,QAAA,eAC5BpC,OAAA;YACAuD,QAAQ,EAAEvB,UAAU,CAACsB,KAAK,GAAG,CAAC,CAAE;YAC5BE,IAAI,EAAC,QAAQ;YACbrB,SAAS,EAAG,WAAUnB,UAAU,KAAKsC,KAAK,GAAG,CAAC,GAAG,SAAS,GAAG,WAAY,EAAE;YAC3EG,OAAO,EAAEA,CAAA,KAAMxC,aAAa,CAACqC,KAAK,GAAG,CAAC,CAAE;YAAAlB,QAAA,EAEvCkB,KAAK,GAAG;UAAC;YAAAf,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,OACN;QAAC,GARHY,KAAK;UAAAf,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,OASV,CACR;MAAC;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OACD,CAAC,eAEN1C,OAAA;QAAQwD,IAAI,EAAC,QAAQ;QAACrB,SAAS,EAAC,sBAAsB;QAAAC,QAAA,EAAC;MAAQ;QAAAG,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,OAAQ,CAAC;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA,OACtE,CAAC;EAAA;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACN,CAAC;AAEd,CAAC;AAAAlC,EAAA,CAzFKD,iBAAiB;EAAA,QACFV,WAAW,EAGdC,SAAS;AAAA;AAAA4D,EAAA,GAJrBnD,iBAAiB;AA2FvB,eAAeA,iBAAiB;AAAC,IAAAmD,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}